<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Popacorn - Cart</title>
  <link rel="stylesheet" href="./style.css">
  <link rel="icon" href="./favicon.ico" type="image/x-icon">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,100..1000;1,9..40,100..1000&display=swap"
    rel="stylesheet">
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,1,0" />
  <script src="https://kit.fontawesome.com/3f34c302de.js" crossorigin="anonymous"></script>
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"
    integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
</head>

<body>

  <main>


    <div class="navBar">
      <h1 style="margin:0;margin-left:15px;">POPACORN</h1>


      <div id="mbar">
        <div class="mas">
          <i class="fa-solid fa-bag-shopping" style="margin:0;"></i>
          <div id="cartCount">
            <p id="cartCountP"></p>
          </div>
        </div>
        <i class="fa-solid fa-bars mab mbarc"></i>
        <i class="fa-solid fa-xmark max mbarc" id="x"></i>

      </div>

    </div>
    <div id="menu">
      <h4 class="menulink" id="mlStore" style="margin:0;margin-left:100px">Store</h4>
      <h4 class="menulink" id="mlDelivery" style="margin:0;margin-left:100px">Delivery</h4>
      <h4 class="menulink" id="mlContact" style="margin:0;margin-left:100px">Contact Us</h4>
    </div>
    <div id="cart">
      <h1>Your Shopping Cart</h1>
      <hr style="color:black;width:100%">
      <div id="cmain">
        <h4 id="empty">Your cart is empty</h4>
        <div id="cartItems">
        </div>
      </div>
  </main>
  <script src="index.js"></script>
  <script>
    const formatter = new Intl.NumberFormat('en-US', {
      style: 'decimal',
      maximumFractionDigits: 2,
      minimumFractionDigits: 2

    });

    if (localStorage.getItem("cart") != null) {
      $("#empty").css("display", "none");
      $("#storeL").css('display', "none");
      const PRODUCTS = {
        "garliccheese": {
          "img": "./assets/garliccheese.jpg",
          "title": "Garlic Cheese",
          "cost": 90.00,
        },
        "cheesecaramel": {
          "img": "./assets/cheesecaramel.jpg",
          "title": "Cheese Caramel",
          "cost": 100.00,
        },
        "caramelchocolate": {
          "img": "./assets/chocolatecaramel.jpg",
          "cost": 100.00,
          "title": "Chocolate Caramel",
        },
        "classiccaramel": {
          "img": "./assets/classiccaramel.jpg",
          "cost": 90.00,
          "title": "Classic Salted Caramel",
        },
        "cookiesandcream": {
          "img": "./assets/cookiesandcream.jpg",
          "cost": 100.00,
          "title": "Cookies and Cream",
        }
      }
      let cart = JSON.parse(localStorage.getItem('cart'));
      for (let item of cart) {

        const productData = PRODUCTS[item.id];
        console.log(productData.img);
        const primaryCost = productData.cost;
        const addons = item.addons;
        let addonscount = 0;
        let addonstext = "Addons: ";
        for (let addondat of Object.keys(addons)) {
          const addon = addons[addondat];
          if (addon.val == false) {
            continue;
          }
          if (addonscount != 0) {
            addonstext += ", ";
          }
          addonstext += addon.name;
          addonscount += 1;
        }
        let secondaryCosts = addonscount * 20.00;
        const final = primaryCost + secondaryCosts;
        if (addonscount == 0) {
          addonstext = "No Addons";
        }

        $("#cartItems").append(`
          <div class="cartItem">
            <div class="delete">
              <i class="fa-solid fa-xmark"></i>
            </div>
            <img src="${productData.img}"/>
            <div class="itemInfo">
              <h3>${productData.title}</h3>
              <p>${addonstext}</p>

            </div>
            <div class="costInfo">
              <p class="primaryCost">৳${formatter.format(primaryCost)}</p>
              <p>৳${formatter.format(secondaryCosts)}</p>
              <p class="finalCost">৳${formatter.format(final)}</p>
            </div>
          </div>
          `
        )
      }
    }



  </script>


</body>

</html>